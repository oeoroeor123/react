<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 
    react 사용을 위한 cdn 링크 추가
    https://ko.legacy.reactjs.org/docs/cdn-links.html
  -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!--
  babel 사용을 위한 cdn 링크 추가
  https://babeljs.io/setup#installation 
  -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <title>Document</title>
</head>
<body>

  <!--
    React.useEffect()

    1. 렌더링 이후에 수행할 내용을 처리하는 훅(Hooks) 이다.
    2. 클래스 컴포넌트의 라이프사이클 메소드 componentDidMount(), componentDidUpdate() 를 대체할 수 있다.
    3. 형식
       1) undefined를 반환(반환 없음)
       2) React.useEffect(setup, dependencies(선택사항))
          (1) setup
              동작할 함수
          (2) dependencies
              필수가 아닌 선택 인자
              '의존성 배열'이라고 한다.
              setup 함수에서 사용하는 모든 반응형 값(props, state, 변수, 함수 등)이 포함될 수 있다.
              dependencies가 없는 경우             : setup 함수가 초기 렌더링, 리 렌더링에서 모두 동작
              dependencies가 비어 있는 배열인 경우 : setup 함수가 초기 렌더링에서만 동작 (한 번만 실행된다.)
              dependencies가 값을 가진 배열인 경우 : 가지고 있는 값이 변하면 setup 함수가 리 렌더링에서 동작
       -->

  <div id="root1"></div>
  <script type="text/babel">

    function UseEffectComp1() {
      
      const { useState, useEffect } = React;

      // useEffect의 동작 확인을 위한 usestate 초기값 부여
      const [ now, setNow ] = useState('');

      // dependencies가 없는 경우 초기 렌더링과 리 렌더링 이후에 모두 동작한다. (return 코드 실행 이후에 동작한다.)
      useEffect(() => {
        console.log('useEffect');
      });


      // Now 버튼 클릭 이벤트 핸들러
      const onClickHandler = () => {
        // Now 버튼 클릭 시마다 now state 값이 변경되어(리 렌더링되어) 현재 시간이 나타난다.
        // state의 변경으로 리 렌더링을 수행한다.
        setNow(new Date().toLocaleTimeString());
      }

      return (
      <>  
      <div>dependencies가 없으면 useEffect의 setup 함수가 모든 렌더링에서 동작합니다.</div>
      <button onClick={onClickHandler}> Now </button>
      <h1>{now}</h1>
      </>
      )

    }
    // ReactDOM.createRoot(document.getElementById('root1')).render(<UseEffectComp1/>);

  </script>

  <div id="root2"></div>
  <script type="text/babel">

    function UseEffectComp2() {
      
      const { useState, useEffect } = React;

      // useEffect의 동작 확인을 위한 state 초기값 부여
      const [ now, setNow ] = useState('');

      // dependencies가 비어 있는 배열인 경우, 초기 렌더링에서만 한 번 동작한다.
      useEffect(() => {
        console.log('useEffect');
      }, []);

      // Now 버튼 클릭 이벤트 핸들러
      const onClickHandler = () => {
        // now 클릭 시마다 리 렌더링되어 현재 시간이 나타난다.
        // state의 변경으로 리 렌더링을 수행한다.
        setNow(new Date().toLocaleTimeString());
      }

      return (
      <>  
      <div>dependencies가 비어 있는 배열이면 useEffect의 setup 함수가 초기 렌더링에서만 한 번 동작합니다.</div>
      <button onClick={onClickHandler}> Now </button>
      <h1>{now}</h1>
      </>
      )

    }
    ReactDOM.createRoot(document.getElementById('root2')).render(<UseEffectComp2/>);

  </script>       

</body>
</html>